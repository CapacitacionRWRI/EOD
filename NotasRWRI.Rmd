---
title: "Notas R"
author: "WRI"
date: "8/10/2021"
output: html_document
---
# El ABC de R

## Instalar R

* Dar click [aqui](https://cran.r-project.org) 

* Dependiendo de la computadora que tengas seleccionas el link de Download que coincida con tu computadora. 

* Se abre una pagina con unos paquetes y casi siempre es el primer File que sale pero puedes checar con la descripcion a la derecha y le picas.

* Ya que lo tengas nada más pones continuar, aceptar, instalar a todos los usuarios, continuar y luego instalar. 


Ya que lo tengas, si lo abres puedes programar ahi en la consola pero no es conveniente. Entonces vamos a bajar RStudio que es como un caparazon encima de R. 




Para esto:

* Dar click [aqui](https://www.rstudio.com)

* Darle click en "Products" y luego "RStudio".

* Darle click en "RSTUDIO DESKTOP" y luego en "DOWNLOAD RSTUDIO DESKTOP OPEN SOURCE". 

* Tienes que seleccionar otra vez que tipo de computadora tienes. 

* Ya que se cargo le das doble click pones abrir y ya está. 




 Ya que lo tengas abierto para cambiarle como se ve (en mac pero debe ser parecido en otras):
 
* Te vas hasta arriba junto a la manzana donde dice RStudio y le picas en Preferences.

* Luego en Appearance le das click

* Ahi le puedes poner el tipo de letra, tamaño y el fondo. 

* Le picas "Apply" para ver como se ve.

* Ya que tengas uno que te gusto le picas en "ok".




Para el indentado y hacer el codigo mas legible:

* Te vas hasta arriba junto a la manzana donde dice RStudio y le picas en Preferences.

* Luego te vas a code

* Despues donde dice tab width le pones un numero entre 4 y 8 para que sea legible. 

* Apply y Ok




Para que sea visible el margen y no escribir tanto:

* Te vas hasta arriba junto a la manzana donde dice RStudio y le picas en Preferences.

* Luego te vas a code

* Le das click en Display

* Le pones que se vea el margen.


Para crear un nuevo script le picas en el boton de hasta arriba a la izquierda que tiene un circulo verde con un más y le pones R Script. O también puedes poner "command shift n" en una mac.



Luego para escribir algo por primera vez ponlo entre comillas como "Hola" y luego le picas en Run o, en una mac se puede, command enter. Y para guardarlo le picas en el boton de guardar en tu script que es el clásico boton de guardar. O "command s".



Luego, para escribir algo que no afecte el codigo, como una nota, le pones un hashtag (#) antes y ya.

## Panel Layout
![Panel Layout](/Users/gonzaloarrangoiz/Desktop/Clases de R WRI/RPanes.jpg)

Editor:

* Donde trabajas el codigo. 

* Puedes hacer comentarios.

* Puedes cambiar de tab como en safari y google chrome.

* Para correr el codigo puedes poner run o con ctrl + enter.

Environment: 

* Hay dos tabs importantes: environment y history.
  + History:
    - Reporte de lo que haz hecho.
    - Puede correr otra vez commandos si les das click doble vez.
  + Environment: 
    - Objetos que haz creado.
    - Todos los objetos que tienes en la memoria.
    - Da informacion util de los objetos.
    - Puedes borrar todo con la escoba. 

Consola: 

* Puedes poner codigo y correrlo inmediatamente

* Sale cualquier error o warning en la salida del codigo escrito ahi o en el editor. 
  + error: inidica que el codigo esta mal. 
  + warning: indica que puede estar mal o bien.


Buscador:

* Files: 
  + Salen tus archivos y los puedes buscar.

* Plots y Viewer:
  + Aqui se pueden ver las graficas que hagas.
  + Puedes guardar las graficas y todo con Export.

* Packages:
  + Instalar nuevos paquetes y descargarlos, pero mejor hacerlo con codigo.
  
* Help:
  + Cuando pides ayuda aparece aqui la ayuda. 




## Tipo de variables (Atomicas)

El operador para asignar un valor funcion a una variable es "<-".
el equivalente en python es "="} 




```{r}
#Numero entero:
x <- 2L # aqui le asigne a la x el valor de 2 y para que sea un numero entero le tengo que poner una L mayúscula a lado.

#Para checar tipo de varibale:
typeof(x) # Y te sale que es un "integer"


#double:
 y <-  2.5

 typeof(y) #aqui te saldria que es un "double". Con estos puedes hacer operaciones numéricas.

 
 #complejo:
 z <- 3 + 2i

 typeof(z) # te sale que es "complex"}


 #character 
a <- "h" 

typeof(a) # y te sale que es un "character"}



 #logico 

 g1 <- T 

 typeof(g1) # te sale que es un "logical"


 g2 <- FALSE

 typeof(g2) # te sale que es un "logical"

```



Ahora, si le picas a la escoba limpias todo tu environment y ya no tienes variables guardadas. 

 

R solo guarda las variables, matrices, dataframes, etc., en la memoria RAM. Puedes guardar la sesion al finalizar, y cuando re inicies las volverá a cargar. 

 

Tambien con el comando rm( ) puedes quitar variables en especifico. Si vuelves a definir una variable o cualquier objeto, R la sobre escribirá sin preguntar nada antes. Asi:

```{r}
k <- 5

k # Sale 5

rm(k)

# k  # Ya no sale

 

j <- 3

j  # Sale 3

j <- 4

j  # Sale 4
```



### operaciones
```{r}
 A <- 10

 B <- 5

 C <- A + B # y te sale el resultado en tu environment a la derecha

 C # y se imprime el resultado en la consola



 var1 <- 2.5

 var2 <- 4



 resultado <- var1 / var2
 resultado



 answer <- sqrt(var2) # variables pueden servir como argumentos de una funcion.

 answer



 saludo <- "Hola"

 nombre <- "Carlos"

 mensaje <- paste(saludo, nombre)

 mensaje
 
```



### operaciones logicas
```{r}
4 < 5 # te sale que es "TRUE"

10 > 100  # te sale que es "FALSE"

4 == 5 # te sale que es "FALSE"
```

### Resumen de operaciones
```{r}
# ==
# !=
# <
# >
# <=
# >=
# !
# |
# \&
# isTRUE(x)
```

```{r}
resultado <- 4 < 5

resultado

typeof(resultado)

 
resultado2 <- !TRUE

resultado2
 

resultado | resultado2 # sale "TRUE" porque es uno u otro.

resultado & resultado2 # sale "FALSE" porque estas requiriendo que los dos sean.

 isTRUE(resultado)  # sale "TRUE"
 
```


 
## Vectores y otros fundamentos

### vectores

#### ¿Qué es un vector? ¿Como se indexiona en R?

![Indexacion de vectores](https://media.geeksforgeeks.org/wp-content/uploads/20200409134016/Vectors-in-R.jpg)

En otros programas como en Python la indexacion empieza en cero, por esto es importante recordar que en R se empieza en 1.

```{r}
# ¿Vector numérico?
c(1,2,3,4,5)

# ¿Vector de character? tiene que llevar comillas " "
c("a", "b", "c", "d")

# ¿Qué pasa si mezclas un numero con characters? 

c(1,2,"a","b","c") # Convierte a los números en character por facilidad. 


# Secreto de R: un solo número también se guarda como un vector de tamaño 1.
vectorUno <- 3
is.vector(vectorUno)

```



```{r}
 Vector1 <- c(3, 45, 56, 732)

 Vector1



 is.numeric(Vector1) # Te regresa un "TRUE".

 is.integer(Vector1) # Te regresa un "FALSE".
 
 is.double(Vector1) # Te regresa un "TRUE" porque anticipa que vas a hacer operaciones numericas con este vector

 

 Vector2 <- c(3L, 12L, 243L, 0L)



 is.numeric(Vector2) # Te regresa un "TRUE".

 is.integer(Vector2) # Te regresa un "TRUE"

 is.double(Vector2) # Te regresa un "FALSE"

 

 Vector3 <- c("a", "B23", "Hola", 7)

 Vector3


 is.character(Vector3) # Te regresa un "TRUE"

 is.numeric(Vector3) # Te regresa un "FALSE"
 
```


```{r}
seq()  # Sequence similar a ':'



rep()  # Replicate

 getwd()

seq(1,15) # Te salen los números del 1 al 15

1:15 # Igual
```


![argumentos de funcion](/Users/gonzaloarrangoiz/Desktop/Clases de R WRI/Argumentos.png)


```{r}
seq(1, 15, 2)  # Step

z <- seq(1,15,4)

z


rep(3, 50)

d <- rep(3, 50)


rep("a", 5)


rep(c(2, 4, 5), 5)


rep(c(2, 4, 5), each = 5)

 
x <- c(80, 20)

y <- rep(x, 10)

y
 
```


### [ ]

```{r}
w <- c("a", "b", "c", "d", "e")

w


w[1]  # Esto te da el primer elemento "a"

w[-1]  # Todos excepto la primera

v <- w[-3]  # Todos excepto el de en medio. Y lo meti en una variable v

w[1:3]  # podemos poner un vector como este de secuencia

w[c(1,3,5)]  # asi igual

w[c(-2, -4)]  # Lo mismo con negativos

w[-3 : -5]  

```



### Operaciones vectoriales
```{r}
x <- rnorm(5)

x

 

print(x[1])

print(x[2])

print(x[3])

print(x[4])

print(x[5])

# podriamos usar un loop aqui para hacer operaciones con este vector, pero veremos loops más adelante y de todas maneras esta mejor de la siguiente manera con vectores:

N <- 100

a <- rnorm(N)

b <- rnorm(N)


c <- a * b   # Esto con loops es mucho más largo y complicado que una sola linea de codigo como esta y ese es la ventaja de hacer operaciones vectoriales en R. Y también es mucho más rápido para R hacer operaciones de esta manera que con loops.
 
```



### Funciones

Ya vimos varias como saben.

Estas son las que vimos. (ponganle un signo de interrogacion a la izquierda para aprender más sobre la funcion y ver que más se le puede agregar y vean que pasa para ver como les puede servir):
```{r}
?rnorm()
?c()
?seq()
?print()
?is.numeric()
?is.integer()
?is.double()
?is.character()
?typeof()
?sqrt()
?paste()

```


### Paquetes

Los paquetes son collecciones de funciones de R, datos y codigo compilado en un formato bien definido. El directorio donde los paquetes se almacenan se llama biblioteca "library".

 
A la derecha en la ventana de abajo dale click en "Packages" y ahi salen todos los paquetes. Los que estan seleccionados en azul son los que están activos ahora.

Ahora, vamos a instalar el paquete ggplot2 como ejemplo.
```{r}
# install.packages(ggplot2)  # si no lo tienes instalado usa esto

# Ahora para activar el paquete:
library(ggplot2)

# Para checar vemos que tenemos ya cosas del paquete:}
?qplot
?ggplot


```


## Matrices

Indexacion
![Indexacion de matrices](/Users/gonzaloarrangoiz/Desktop/Clases de R WRI/matindex.jpg)


### Crear una matriz

Nota al margen: en una matriz todas las columnas son de la misma clase, generalmente numérica, pues las matrices se suelen utilizar principalmente para operaciones de algebera lineal, cuando combinamos diferentes clases de columnas (numeros-caracteres-factores-etc) entonces tenemos un dataframe.}


```{r}
?matrix() # esta funcion dobla los vectores como una serpiente entonces no es tan buena herramienta. Se puede doblar de manera vertical u horizontal.

?rbind() #lo que hace es juntar vectores en filas una en cima de la otra. Pero tienen que ser del mismo tamaño si no no se puede.

?cbind() #conecta vectores en una matriz por columnas. Igual que rbind pero por columnas.
```

```{r}
creando.mat <- 1:20

creando.mat

A <- matrix(creando.mat, 4, 5) # nada más checar que el número de columnas y filas coincida con el numero de datos para que se pueda hacer.

A


# Ya viendo la matriz como llegarias al numero 10?:
 A[2,3] # Sale el número 10.

  
 
# Ahora para hacer la matriz por filas:
B <- matrix(creando.mat, 4, 5, byrow=T)
B
 
 
# Ahora con esta matriz como llegarias al numero 10?:}
B[2,5]




# rbind():
r1 <- c("Hola", "buenos", "dias")

r2 <- c("que", "estés", "bien")

r3 <- c(1, 2, 3)


C <- rbind(r1, r2, r3)




# cbind():

c1 <- 1:5

c2 <- -1:-5



D <- cbind(c1, c2)

D

```



### Nombrando las dimensiones

Esta es la matriz E y hay 4 formas de sacar el valor c de esta matriz como se ve a continuacion:

```{r include=FALSE}
E <- rbind(Hola = c(1,2,3,4), Como = c("a","b","c","d"), Estas = c(5,"z",8,"k"))
colnames(E) <- c("Muy", "Bien,", "Tu", "?")
```

```{r echo=FALSE}
E
```


```{r}

E[2,3]

 
E["Como",3]

 
E["Como","Tu"]

 
E[2,"Tu"]

```


vectores:
```{r}
WRI <- 1:5
WRI

# Para ponerle nombres:

# Checar nombres:
names(WRI)  # sale NULL

# Asignar nombres:

names(WRI) <- c("a", "b", "c", "d", "e")

WRI # ya salen los nombres

# Para quitar nombres:
names(WRI) <- NULL

WRI # ya sale sin nombres

```


matrices:
```{r}
rep(c("a", "B", "zZ"), 3)
vector.nombres <- rep(c("a", "B", "zZ"), each=3)

matriz.nombres <- matrix(vector.nombres, 3, 3)

matriz.nombres

rownames(matriz.nombres) <- c("Hola", "como", "estas?")

matriz.nombres # ya con nombres

colnames(matriz.nombres) <- c("X", "Y", "Z")

matriz.nombres # ya con nombres en columnas.

```


Que si queremos poner un cero en medio de la matriz en vez de una "B"
```{r}
matriz.nombres["como", "Y"] <- 0

matriz.nombres

rownames(matriz.nombres)
rownames(matriz.nombres) <- NULL
```




### operaciones matriciales

De aqui en adelante usaremos unas matrices que cree en R y se las paso.
```{r echo=FALSE}
#Anios
Anios <- c("2008","2009","2010","2011","2012","2013","2014","2015","2016","2017")

#Paises
Paises <- c("Brazil","China","Colombia","Francia","Alemania","India","Indonesia","Mexico","CoreaSur","EstadosUnidos")

#PIB (US a precios actuales)
Brasil_PIB <- c(1695824565983.20,1667019783585.08,2208871646202.82,2616200980392.16,2465188674415.03,2472806919901.67,2455993625159.37,1802214373741.32,1795700168991.49,2062831045935.95)
China_PIB <- c(4594307032660.79,5101703073086.04,6087163874512.21,7551500124203.36,8532229986993.65,9570406235659.64,10475682920594.50,11061553079876.40,11233276536737.20,12310409370892.80)
Colombia_PIB <- c(242186950900.78,232397835678.34,286563105192.46,334943871931.75,370921320483.84,382116126448.56,381112119657.45,293481748240.78,282825009887.46,311883730690.13)
France_PIB <- c(2918382891460.38,2690222283967.77,2642609548930.36,2861408170264.60,2683825225092.63,2811077725703.59,2852165760630.27,2438207896251.84,2471285607081.72,2595151045197.65)
Germany_PIB <- c(3730027830672.33,3397791053070.30,3396354075663.73,3744408602683.94,3527344944139.83,3732743446218.92,3883920155292.26,3356235704119.75,3467498002104.33,3682602479929.42)
India_PIB <- c(1198895582137.51,1341886602798.69,1675615335600.56,1823050405350.42,1827637859135.70,1856722121394.53,2039127446298.55,2103587817041.78,2294797978291.98,2652754685834.59)
Indonesia_PIB <- c(510228634992.26,539580085612.40,755094160363.07,892969107923.09,917869910105.75,912524136718.02,890814755233.23,860854235065.08,931877364177.74,1015618742565.81)
Mexico_PIB <- c(1109989063586.62,900045350649.35,1057801295584.05,1180489601957.61,1201089987015.45,1274443084716.57,1315351183524.54,1171867608197.72,1078490651625.31,1158913035796.37)
SouthKorea_PIB <- c(1047339010225.25,943941876218.74,1144066965324.49,1253223044718.99,1278427634342.59,1370795199976.18,1484318219633.63,1465773245547.15,1500111596236.37,1623901496835.79)
US_PIB <- c(14712844084000.00,14448933025000.00,14992052727000.00,15542581104000.00,16197007349000.00,16784849196000.00,17527163695000.00,18224704440000.00,18714960538000.00,19519353692000.00)
#Matrix
PIB <- rbind(Brasil_PIB,China_PIB,Colombia_PIB,France_PIB,Germany_PIB,India_PIB,Indonesia_PIB,Mexico_PIB,SouthKorea_PIB,US_PIB
)
rm(Brasil_PIB,China_PIB,Colombia_PIB,France_PIB,Germany_PIB,India_PIB,Indonesia_PIB,Mexico_PIB,SouthKorea_PIB,US_PIB
)
colnames(PIB) <- Anios
rownames(PIB) <- Paises

#Emisiones 
Brasil_E	<- c(1455.75,1434.3,1541.66,1308.92,1354.86,1372.14,1416,1411.95,1381.11,1392.8)
China_E <- c(8398.83,8992.51,9828.01,10784.95,11110.34,11568.63,11583.36,11578.25,11577.98,11780.99)
Colombia_E <- c(316.82,320.76,325.18,182.62,181.2,188.01,195.2,195.22,222.64,216.67)
France_E	<- c(430.57,412.26,415.98,373.01,375.99,376.73,343.69,349.62,349.4,352.07)
Germany_E <-	c(891.36,834.11,864.77,812.55,826.67,843.91,803.64,807.42,810.14,792.63)
India_E <-	c(2185.08,2339.28,2449.3,2798.04,2947.94,3003.54,3175.79,3188.03,3230.06,3356.7)
Indonesia_E <-	c(2043.38,2478.22,2079.39,2335.3,2357.19,2294.34,2729.18,2776.53,2228.89,2275.4)
Mexico_E	<- c(676.44,660.37,663.2,679.56,669.68,665.44,653.91,680.48,694.52,684.55)
SouthKorea_E <-	c(531.57,545.24,598.01,631.29,636.13,635.5,624.8,646.29,657.41,670.81)
US_E	<- c(6267.37,5865.85,6111.83,6235.82,5936.1,6056.33,6097.71,5973.16,5833.01,5766.92)
#Matrix
Emisiones <- rbind(Brasil_E,China_E,Colombia_E,France_E,Germany_E,India_E,Indonesia_E,Mexico_E,SouthKorea_E,US_E
)
rm(Brasil_E,China_E,Colombia_E,France_E,Germany_E,India_E,Indonesia_E,Mexico_E,SouthKorea_E,US_E
)
colnames(Emisiones) <- Anios
rownames(Emisiones) <- Paises

#Poblacion
Brasil_Pob <- c(192030362,193886508,195713635,197514534,199287296,201035903,202763735,204471769,206163058,207833831)
China_Pob <- c(1324655000,1331260000,1337705000,1344130000,1350695000,1357380000,1364270000,1371220000,1378665000,1386395000)
Colombia_Pob <- c(44254972,44750054,45222699,45662747,46075721,46495492,46967706,47520667,48175048,48909844)
France_Pob <- c(64374984,64707040,65027507,65342780,65659809,65998687,66312067,66548272,66724104,66864379)
Germany_Pob <- c(82110097,81902307,81776930,80274983,80425823,80645605,80982500,81686611,82348669,82657002)
India_Pob <- c(1200669765,1217726215,1234281170,1250288729,1265782790,1280846129,1295604184,1310152403,1324509589,1338658835)
Indonesia_Pob <- c(235469762,238620563,241834215,245116206,248452413,251806402,255129004,258383256,261554226,264645886)
Mexico_Pob <- c(110815271,112463887,114092963,115695473,117274155,118827161,120355128,121858258,123333376,124777324)
SouthKorea_Pob <- c(49054708,49307835,49554112,49936638,50199853,50428893,50746659,51014947,51217803,51361911)
US_Pob <- c(304093966,306771529,309321666,311556874,313830990,315993715,318301008,320635163,322941311,324985539)
#Matrix
Poblacion <- rbind(Brasil_Pob,China_Pob,Colombia_Pob,France_Pob,Germany_Pob,India_Pob,Indonesia_Pob,Mexico_Pob,SouthKorea_Pob,US_Pob)
rm(Brasil_Pob,China_Pob,Colombia_Pob,France_Pob,Germany_Pob,India_Pob,Indonesia_Pob,Mexico_Pob,SouthKorea_Pob,US_Pob)
colnames(Poblacion) <- Anios
rownames(Poblacion) <- Paises
```


```{r}
Emisiones

rownames(Emisiones)

colnames(Emisiones)

Emisiones["Mexico", "2012"]
 
PIB

round(PIB / Poblacion, 1)


round(Emisiones / Poblacion)
 
```

Igual se puede sumar, restar, multiplicar y asi.




### Matplot()

```{r}
?matplot

matplot(PIB)

PIB

t(PIB)

matplot(t(PIB))

matplot(t(PIB), type = "b", pch = 15:18, col= c(1:4, 6))

legend("bottomleft", inset = 0.01, legend = Paises, col= c(1:4, 6), pch=15:18, horiz=F)

 

matplot(t(PIB/Poblacion), type = "b", pch = 15:18, col= c(1:4, 6))

legend("bottomleft", inset = 0.01, legend = Paises, col= c(1:4, 6), pch=15:18, horiz=F)

 

matplot(t(Emisiones/PIB), type = "b", pch = 15:18, col= c(1:4, 6))

legend("bottomleft", inset = 0.01, legend = Paises, col= c(1:4, 6), pch=15:18, horiz=F)

```




### Subsetting
```{r}
x <- c("a", "b", "c", "d", "e")

x

x[c(1,5)]

x[1]
```


```{r}
Emisiones

Emisiones[1:3, 6:10]  # De primeros tres paises años 2013-2017

Emisiones[c(1,10),] # Primer y último pais

Emisiones[,c("2008", "2009")] # Todos los paises solo años 2008 y 2009


Emisiones[1,]



is.matrix(Emisiones[1,])

is.vector(Emisiones[1,])

 

Emisiones[1,5] # Igual el mismo problema porque R esta tratando de adivinar que quieres y como es de dos y una dimension respectivamente piensa que tal vez querias un vector.

 

Emisiones[1,,drop=F] # Ya como matriz.

Emisiones[1,5,drop=F] # Ya arreglado.

```




### Visualizando Subconjuntos
```{r}
matplot(t(PIB/Poblacion), type = "b", pch = 15:18, col= c(1:4, 6))

legend("bottomleft", inset = 0.01, legend = Paises, col= c(1:4, 6), pch=15:18, horiz=F)

 

# Para solo los primeros 10

SoloTres <- (PIB/Poblacion)[1:3,]

matplot(t(SoloTres), type = "b", pch = 15:18, col= c(1:4, 6))

legend("bottomleft", inset = 0.01, legend = Paises[1:3], col= c(1:4, 6), pch=15:18, horiz=F)



SoloMex <- (PIB/Poblacion)[8,,drop=F]

matplot(t(SoloMex), type = "b", pch = 15:18, col= c(1:4, 6))

legend("bottomleft", inset = 0.01, legend = Paises[8], col= c(1:4, 6), pch=15:18, horiz=F)

```

 

### Crear una funcion
```{r}
MiVisualizacion <- function(filas){

Subdatos <- (PIB/Poblacion)[filas,,drop=F]

matplot(t(Subdatos), type = "b", pch = 15:18, col= c(1:4, 6))

legend("bottomleft", inset = 0.01, legend = Paises[filas], col= c(1:4, 6), pch=15:18, horiz=F)

}


MiVisualizacion(2:5)

MiVisualizacion2 <- function(datos,filas){

Subdatos <- datos[filas,,drop=F]

matplot(t(Subdatos), type = "b", pch = 15:18, col= c(1:4, 6))

legend("bottomleft", inset = 0.01, legend = Paises[filas], col= c(1:4, 6), pch=15:18, horiz=F)

 }


MiVisualizacion2(Emisiones, 2:5)

```


Agregando opciones predeterminadas:
```{r}
MiVisualizacion3 <- function(datos, filas = 1:10){

Subdatos <- datos[filas,,drop=F]

matplot(t(Subdatos), type = "b", pch = 15:18, col= c(1:4, 6))

legend("bottomleft", inset = 0.01, legend = Paises[filas], col= c(1:4, 6), pch=15:18, horiz=F)

}

MiVisualizacion3(Emisiones)

```



### Análisis

falta


# Bases de datos

Para esta seccion haremos un proyecto con la EOD 2017

## 1. Introducción

Este análisis tiene el objetivo de validar la suficiencia de casos válidos para lograr muestras 
estadísticamente representativas en los 194 distritos oricinales en los que se subdividió el análisis 
de la EOD 2017.

Como resultado, se espera identificar los parámetros necesarios para replantear las unidades de análisis
de manera que se logre robustecer la base de datos y eliminar posibles sesgos en su implementación

### Importar base de datos a R (.csv)

Dos métodos:

#### Método 1: manual

```{r}
# basedatos <- read.csv(file.choose())

# después de ejecutarla buscas y eliges la base de datos y ya

# basedatos1

```



#### Método 2: con working directory

```{r}
getwd() # al ejecutarla sale tu working directory, es decir donde se guarda todo lo que estas haciendo en R.

# Para cambiarlo:

# Windows:

# setwd("C:$\backslash \backslash$Users$\backslash \backslash$NombreGuardado$\backslash \backslash$Desktop$\backslash \backslash$Nombre de Folder")



# Mac:

# setwd("/Users/NombreGuardado/Desktop/Nombre de Folder")



# rm(basedatos1)

# basedatos1 <- read.csv("base de datos.csv")

# basedatos1

```

#### Lo vamos a hacer casi como el segundo metodo pero es un como truco para que todo se guarde en el mismo lugar:

##### Esta linea la tuve que correr yo en vez de la siguiente pero puede que con solo la siguiente les sirva a ustedes:
```{r Setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "~/")
```

##### La siguiente (no la voy a correr porque con el de antes me sirve a mi):
```{r}
#setwd("~/")
```


##### Crear y establecer directorio de trabajo
```{r Crear y establacer directorios de trabajo, include=TRUE}
if (!dir.exists("analisis_eod")) {
  dir.create("analisis_eod")
}
setwd("~/analisis_eod")
```

##### Descarga de archivos desde fuente INEGI
Se verifica la existencia y en su caso de descargan y descomprimen los archivos conteniendo las bases 
de datos de la EOD-2017 desde la URL de INEGI. Tamaño aproximado de la descarga 25 MB. Tamaño de las 
bases de datos descomprimidas: 283 MB
```{r URL que contiene la descarga del archivo, verificación y descarga, include=TRUE}
url_eod <- "https://www.inegi.org.mx/contenidos/programas/eod/2017/datosabiertos/eod_2017_csv.zip"
eod_file <- "eod_2017_csv.zip"
if (!file.exists(eod_file)) {
  download.file(url_eod, eod_file, mode = "wb")
}
if (!dir.exists("eod_2017_csv")) {
  unzip(eod_file)
}
```

##### Asignación de bases de datos a variables en R
```{r Cargar CSVs, include=TRUE}
Hogar <- read.csv("thogar_eod2017/conjunto_de_datos/thogar.csv")
Vivienda <- read.csv("tvivienda_eod2017/conjunto_de_datos/tvivienda.csv")
PerfilSociodemografico <- read.csv("tsdem_eod2017/conjunto_de_datos/tsdem.csv")
Viajes <- read.csv("tviaje_eod2017/conjunto_de_datos/tviaje.csv")
Transporte <- read.csv("ttransporte_eod2017/conjunto_de_datos/ttransporte.csv")
```


#### Explorar Base de Datos

Vamos a trabajar con la de Perfil Sociodemografico.

```{r}
PerfilSociodemografico

nrow(PerfilSociodemografico)

ncol(PerfilSociodemografico)

head(PerfilSociodemografico)

tail(PerfilSociodemografico)

head(PerfilSociodemografico, 10)


str(PerfilSociodemografico) # structure

summary(PerfilSociodemografico)
  
```
Escribir conclusiones sobre la exploración de los datos


Escribir estrategia para corregir clases de variables
```{r, include=TRUE}
PerfilSociodemografico$edad <- as.numeric(PerfilSociodemografico$edad)
PerfilSociodemografico$p5_4 <- as.numeric(PerfilSociodemografico$p5_4)
PerfilSociodemografico$p6_4 <- as.numeric(PerfilSociodemografico$p6_4)
PerfilSociodemografico$sexo <- as.factor(PerfilSociodemografico$sexo)
PerfilSociodemografico$distrito <- as.factor(PerfilSociodemografico$distrito)
str(PerfilSociodemografico)
```
 


#### $

```{r}
PerfilSociodemografico

head(PerfilSociodemografico)

PerfilSociodemografico[3, 3]

PerfilSociodemografico[3, "n_ren"]



PerfilSociodemografico$distrito

PerfilSociodemografico[, "distrito"] # igual que el pasado

PerfilSociodemografico$distrito[2]



levels(PerfilSociodemografico$distrito) # Imprime los factores

```


#### Operaciones con bases de datos

##### Subconjuntos
```{r}
PerfilSociodemografico[1:10,]

PerfilSociodemografico[3:9,]

PerfilSociodemografico[c(4,100),]



is.data.frame(PerfilSociodemografico[1,]) # Ya no se necesita el drop=F



is.data.frame(PerfilSociodemografico[,1]) # No es, aquí si se necesita

is.data.frame(PerfilSociodemografico[,1, drop=F]) # Ahora si ya


# Multiplicar y sumar (Aunque no hagan mucho sentido los ejemplos)

head(PerfilSociodemografico)

PerfilSociodemografico$edad * PerfilSociodemografico$distrito

PerfilSociodemografico$edad + PerfilSociodemografico$distrito



# Añadir columna
head(PerfilSociodemografico)

PerfilSociodemografico$MyCalc <-  PerfilSociodemografico$edad * PerfilSociodemografico$distrito


PerfilSociodemografico$xyz <- 1:200117  # Se supone que si pongo por ejemplo 1:5 sirve y se reciclan los numeros pero no me esta funcionando en markdown entonces puse uno del tamano de las filas.

head(PerfilSociodemografico, n=12)



# Remover columna

head(PerfilSociodemografico)

PerfilSociodemografico$MyCalc <- NULL

PerfilSociodemografico$xyz <- NULL

head(PerfilSociodemografico)

```



#### Filtar base de datos
```{r}
head(PerfilSociodemografico)

filtro <- PerfilSociodemografico$edad < 18

PerfilSociodemografico[filtro,]


# menores a 35 anios
PerfilSociodemografico[PerfilSociodemografico$edad > 35,]

# Mayor de 40 con nivel de escolaridad menor a 6
PerfilSociodemografico[PerfilSociodemografico$edad > 40 & PerfilSociodemografico$niv < 6,]

#Gente del distrito 17
PerfilSociodemografico[PerfilSociodemografico$distrito ==  "17",]



```

Ejercicio: saca toda la informacion de mujeres menores de 18 con nivel de escolaridad menor a 5 del distrito 20.

### Ya con estos conocimientos podemos hacer las pruebas de validacion con el criterio establecido de que debe haber al menos 50 casos por grupo de edad y genero:

#### Pero antes hay que limpiar los datos (De una vez de las 5 bases):
```{r Ver cuantos NA hay, include=FALSE}
str(Hogar)
summary(Hogar)
Hogar[complete.cases(Hogar),] #Aqui se filtro por los datos completos pero aparentemente no hay filas con casos completos.
Hogar[!complete.cases(Hogar),] # Aqui se filtro por casos no completos, es decir NA solo con agregarle el NOT

```

```{r Hogar proporciones, include=FALSE}
a1 <- length(Hogar$p2_2)
b1 <- length(which(is.na(Hogar$p2_2)))
proporcionNAp2_2 <- round((b1 / a1)*100,2)

a2 <- length(Hogar$p2_2b_1)
b2 <- length(which(is.na(Hogar$p2_2b_1)))
proporcionNAp2_2b_1 <- round((b2 / a2)*100,2)


a3 <- length(Hogar$p2_2b_2)
b3 <- length(which(is.na(Hogar$p2_2b_2)))
proporcionNAp2_2b_2 <- round((b3 / a3)*100,2)

a4 <- length(Hogar$p2_2b_3)
b4 <- length(which(is.na(Hogar$p2_2b_3)))
proporcionNAp2_2b_3 <- round((b4 / a4)*100,2)

a5 <- length(Hogar$p2_2b_4)
b5 <- length(which(is.na(Hogar$p2_2b_4)))
proporcionNAp2_2b_4 <- round((b5 / a5)*100,2)


HogarProporcionesNAs <- cbind(p2_2 = proporcionNAp2_2, p2_2b_1 =  proporcionNAp2_2b_1, p2_2b_2 = proporcionNAp2_2b_2, p2_2b_3 = proporcionNAp2_2b_3, p2_2b_4 = proporcionNAp2_2b_4)


rownames(HogarProporcionesNAs) <- c("Proporcion de NA")

HogarProporcionesNAs

```




```{r echo=FALSE}

knitr::kable(HogarProporcionesNAs, caption = 'Hogar')

```





```{r Ver NAs de PerfilSociodemografico, include=FALSE}
str(PerfilSociodemografico)
summary(PerfilSociodemografico)
PerfilSociodemografico[!complete.cases(PerfilSociodemografico),]

```

```{r PSD PROPORCIONES, include=FALSE}
c1 <- length(PerfilSociodemografico$niv)
d1 <- length(which(is.na(PerfilSociodemografico$niv)))
proporcionNAniv <- round((d1 / c1)*100,2)

c2 <- length(PerfilSociodemografico$gra)
d2 <- length(which(is.na(PerfilSociodemografico$gra)))
proporcionNAgra <- round((d2 / c2)*100,2)


c3 <- length(PerfilSociodemografico$p3_7)
d3 <- length(which(is.na(PerfilSociodemografico$p3_7)))
proporcionNAp3_7 <- round((d3 / c3)*100,2)

c4 <- length(PerfilSociodemografico$p3_8)
d4 <- length(which(is.na(PerfilSociodemografico$p3_8)))
proporcionNAp3_8 <- round((d4 / c4)*100,2)

c5 <- length(PerfilSociodemografico$p4_2)
d5 <- length(which(is.na(PerfilSociodemografico$p4_2)))
proporcionNAp4_2 <- round((d5 / c5)*100,2)

c6 <- length(PerfilSociodemografico$p4_3)
d6 <- length(which(is.na(PerfilSociodemografico$p4_3)))
proporcionNAp4_3 <- round((d6 / c6)*100,2)


c7 <- length(PerfilSociodemografico$p5_4)
d7 <- length(which(is.na(PerfilSociodemografico$p5_4)))
proporcionNAp5_4 <- round((d7 / c7)*100,2)

c8 <- length(PerfilSociodemografico$p6_4)
d8 <- length(which(is.na(PerfilSociodemografico$p6_4)))
proporcionNAp6_4 <- round((d8 / c8)*100,2)

PerfilSociodemograficoProporcionNAs <- cbind(niv = proporcionNAniv, gra = proporcionNAgra, p3_7 = proporcionNAp3_7, p3_8 = proporcionNAp3_8, p4_2 = proporcionNAp4_2, p4_3 = proporcionNAp4_3, p5_4 = proporcionNAp5_4, p6_4 = proporcionNAp6_4)

rownames(PerfilSociodemograficoProporcionNAs) <- c("Proporcion de NA")

PerfilSociodemograficoProporcionNAs
```




```{r echo=FALSE}
knitr::kable(PerfilSociodemograficoProporcionNAs, caption = 'Perfil Sociodemografico')
```



```{r Viendo NAs de Vivienda, include=FALSE}
str(Vivienda)
summary(Vivienda)
Vivienda[!complete.cases(Vivienda),]

```

```{r Vivienda proporciones, include=FALSE}
e1 <- length(Vivienda$p1_3)
f1 <- length(which(is.na(Vivienda$p1_3)))
proporcionNAp1_3 <- round((f1 / e1)*100,2)


ViviendaProporcionesNAs <- cbind(p1_3 = proporcionNAp1_3)


rownames(ViviendaProporcionesNAs) <- c("Proporcion de NA")

ViviendaProporcionesNAs

```




```{r echo=FALSE}
knitr::kable(ViviendaProporcionesNAs, caption = 'Vivienda')
```




```{r Viendo NAs de Viajes, include=FALSE}
str(Viajes)
summary(Viajes)
Viajes[!complete.cases(Viajes),]

```

```{r Viajes Proporciones, include=FALSE}
g1 <- length(Viajes$p5_18)
h1 <- length(which(is.na(Viajes$p5_18)))
proporcionNAp5_18 <- round((h1 / g1)*100,2)

g2 <- length(Viajes$p5_21_1)
h2 <- length(which(is.na(Viajes$p5_21_1)))
proporcionNAp5_21_1 <- round((h2 / g2)*100,2)


g3 <- length(Viajes$p5_21_2)
h3 <- length(which(is.na(Viajes$p5_21_2)))
proporcionNAp5_21_2 <- round((h3 / g3)*100,2)

g4 <- length(Viajes$p5_22)
h4 <- length(which(is.na(Viajes$p5_22)))
proporcionNAp5_22 <- round((h4 / g4)*100,2)

g5 <- length(Viajes$p5_23)
h5 <- length(which(is.na(Viajes$p5_23)))
proporcionNAp5_23 <- round((h5 / g5)*100,2)

g6 <- length(Viajes$p5_24)
h6 <- length(which(is.na(Viajes$p5_24)))
proporcionNAp5_24 <- round((h6 / g6)*100,2)


g7 <- length(Viajes$p5_25)
h7 <- length(which(is.na(Viajes$p5_25)))
proporcionNAp5_25 <- round((h7 / g7)*100,2)

g8 <- length(Viajes$p5_27_1)
h8 <- length(which(is.na(Viajes$p5_27_1)))
proporcionNAp5_27_1 <- round((h8 / g8)*100,2)

g9 <- length(Viajes$p5_27_2)
h9 <- length(which(is.na(Viajes$p5_27_2)))
proporcionNAp5_27_2 <- round((h9 / g9)*100,2)

g10 <- length(Viajes$p5_27_3)
h10 <- length(which(is.na(Viajes$p5_27_3)))
proporcionNAp5_27_3 <- round((h10 / g10)*100,2)

g11 <- length(Viajes$p5_27_4)
h11 <- length(which(is.na(Viajes$p5_27_4)))
proporcionNAp5_27_4 <- round((h11 / g11)*100,2)

g12 <- length(Viajes$p5_27_5)
h12 <- length(which(is.na(Viajes$p5_27_5)))
proporcionNAp5_27_5 <- round((h12 / g12)*100,2)


g13 <- length(Viajes$p5_27_6)
h13 <- length(which(is.na(Viajes$p5_27_6)))
proporcionNAp5_27_6 <- round((h13 / g13)*100,2)

g14 <- length(Viajes$p5_27_7)
h14 <- length(which(is.na(Viajes$p5_27_7)))
proporcionNAp5_27_7 <- round((h14 / g14)*100,2)

g15 <- length(Viajes$p5_27_8)
h15 <- length(which(is.na(Viajes$p5_27_8)))
proporcionNAp5_27_8 <- round((h15 / g15)*100,2)

ViajesProporcionNAs <- cbind(p5_18 = proporcionNAp5_18, p5_21_1 = proporcionNAp5_21_1, p5_21_2 = proporcionNAp5_21_2, p5_22 = proporcionNAp5_22, p5_23 = proporcionNAp5_23, p5_24 = proporcionNAp5_24, p5_25 = proporcionNAp5_25, p5_27_1 = proporcionNAp5_27_1, p5_27_2 = proporcionNAp5_27_2, p5_27_3 = proporcionNAp5_27_3, p5_27_4 = proporcionNAp5_27_4, p5_27_5 = proporcionNAp5_27_5, p5_27_6 = proporcionNAp5_27_6, p5_27_7 = proporcionNAp5_27_7, p5_27_8 = proporcionNAp5_27_8)

rownames(ViajesProporcionNAs) <- c("Proporcion de NA")

ViajesProporcionNAs

```




```{r echo=FALSE}
knitr::kable(ViajesProporcionNAs, caption = 'Viajes')
```



```{r Viendo Nas de Transporte, include=FALSE}
str(Transporte)
summary(Transporte)
Transporte[!complete.cases(Transporte),]

```

```{r Transporte proporciones, include=FALSE}
i1 <- length(Transporte$p5_17_1c)
j1 <- length(which(is.na(Transporte$p5_17_1c)))
proporcionNAp5_17_1c <- round((j1 / i1)*100,2)

i2 <- length(Transporte$p5_17_2c)
j2 <- length(which(is.na(Transporte$p5_17_2c)))
proporcionNAp5_17_2c <- round((j2 / i2)*100,2)


TransporteProporcionNAs <- cbind(p5_17_1c = proporcionNAp5_17_1c, p5_17_2c = proporcionNAp5_17_2c)

rownames(TransporteProporcionNAs) <- c("Proporcion de NA")

TransporteProporcionNAs

```




```{r echo=FALSE}
knitr::kable(TransporteProporcionNAs, caption = 'Transporte')
```



## Lista de proporciones de NA por base de datos
```{r echo=FALSE, fig.height=5, fig.width=5}

knitr::kables(list(knitr::kable(HogarProporcionesNAs, caption = 'Hogar'), knitr::kable(PerfilSociodemograficoProporcionNAs, caption = 'Perfil Sociodemografico'), knitr::kable(ViviendaProporcionesNAs, caption = 'Vivienda'), knitr::kable(ViajesProporcionNAs, caption = 'Viajes'), Transporte = knitr::kable(TransporteProporcionNAs, caption = 'Transporte')))


```


#### Ahora si la validacion de la base Perfil Sociodemografico


#### lib. necesaria para agrupar (group_by) y resumir (summarise)
```{r Libreria necesaria}
library(dplyr)
```

```{r}
psociodem_gr <- group_by(PerfilSociodemografico, distrito)
psociodem_gr
```

##### Crea una tabla resumen agrupando operaciones por distrito
##### la operación suma los valores "TRUE" de la evaluación que se expresa
```{r}
dist_genero <- summarise(psociodem_gr, 
                         n_mujeres = sum(sexo ==2), 
                         n_hombres = sum(sexo == 1),
                         hom_men_18 = sum(edad < 18 & sexo == 1),
                         muj_men_18 = sum(edad < 18 & sexo == 2),
                         hom_18_35 = sum(edad >= 18 & edad < 35 & sexo == 1),
                         muj_18_35 = sum(edad >= 18 & edad < 35 & sexo == 2),
                         hom_35_65 = sum(edad >= 35 & edad < 65 & sexo == 1),
                         muj_35_65 = sum(edad >= 35 & edad < 65 & sexo == 2),
                         hom_65ymas = sum(edad >= 65 & sexo == 1),
                         muj_65ymas = sum(edad >= 65 & sexo == 2))

knitr::kable(dist_genero, caption = "Casos por Grupo de Edad y Genero")
```

##### Se crea una nueva tabla a la que se le agregan campos que evalúan el cumplimiento 
##### de la condición de 50 casos como mínimo en la base sociodemográfica.
```{r}
resultado_val <- transform(dist_genero, 
                           v_tot_muj = ifelse(n_mujeres < 50, yes = 0, no = 1),
                           v_tot_hom = ifelse(n_hombres < 50, yes = 0, no = 1),
                           v_hom_menos18 = ifelse(hom_men_18 < 50, yes = 0, no = 1),
                           v_muj_menos18 = ifelse(muj_men_18 < 50, yes = 0, no = 1),
                           v_hom_18_35 = ifelse(hom_18_35 < 50, yes = 0, no = 1),
                           v_muj_18_35 = ifelse(muj_18_35 < 50, yes = 0, no = 1),
                           v_hom_35_65 = ifelse(hom_35_65 < 50, yes = 0, no = 1),
                           v_muj_35_65 = ifelse(muj_35_65 < 50, yes = 0, no = 1),
                           v_hom_65ymas = ifelse(hom_65ymas < 50, yes = 0, no = 1),
                           v_muj_65ymas = ifelse(muj_65ymas < 50, yes = 0, no = 1))

knitr::kable(resultado_val)
```

##### Tabla deseada
```{r}
TablaDeseadaPre <- resultado_val[c(1,12:21)]
TablaDeseada <- knitr::kable(resultado_val[c(1,12:21)], caption = "Validacion de datos por edades")
TablaDeseada
```


##### Lista de rangos de edad de si cumplen o no con validez
```{r}
list(HombresMenos18 = length(which(resultado_val$v_hom_menos18 == 0)) == 0,
MujeresMenos18 = length(which(resultado_val$v_muj_menos18 == 0)) == 0,
Hombres18a35 = length(which(resultado_val$v_hom_18_35 == 0)) == 0,
Mujeres18a35 = length(which(resultado_val$v_muj_18_35 == 0)) == 0,
Hombres35a65 = length(which(resultado_val$v_hom_35_65 == 0)) == 0,
Mujeres35a65 = length(which(resultado_val$v_muj_35_65 == 0)) == 0,
Hombres65mas = length(which(resultado_val$v_hom_65ymas == 0)) == 0,
Mujeres65mas = length(which(resultado_val$v_muj_65ymas == 0)) == 0)
```


##### Que variables analizadas aqui tienen puros casos validos
```{r}
CasosTotales <- nrow(resultado_val)
list(HombresMenos18 = length(which(resultado_val$v_hom_menos18 == 1)) == CasosTotales,
MujeresMenos18 = length(which(resultado_val$v_muj_menos18 == 1)) == CasosTotales,
Hombres18a35 = length(which(resultado_val$v_hom_18_35 == 1)) == CasosTotales,
Mujeres18a35 = length(which(resultado_val$v_muj_18_35 == 1)) == CasosTotales,
Hombres35a65 = length(which(resultado_val$v_hom_35_65 == 1)) == CasosTotales,
Mujeres35a65 = length(which(resultado_val$v_muj_35_65 == 1)) == CasosTotales,
Hombres65mas = length(which(resultado_val$v_hom_65ymas == 1)) == CasosTotales,
Mujeres65mas = length(which(resultado_val$v_muj_65ymas == 1)) == CasosTotales)

```


##### ¿Cuáles distritos originales de la EOD tienen datos válidos para todas las variables analizadas?
```{r}
TablaDeseadaPre
NumeroDeVariables <- ncol(TablaDeseadaPre) -1

DistCasosValidos <- data.frame(rowSums(TablaDeseadaPre[,-1]), row.names = levels(PerfilSociodemografico$distrito))

DistritosConTodoValido <- knitr::kable(DistCasosValidos < NumeroDeVariables, caption = "¿Casos Validos Para Todas las Variables?")

DistritosConTodoValido



```

```{r}
ResVal <- resultado_val[c(1,12:21)]
# which.max(ResVal)
?which.max

```

###### Necesito convertir a matriz
```{r}
str(ResVal)
MatrisDistGenero <- as.matrix(ResVal[,2:11])

rownames(MatrisDistGenero) <- dist_genero$distrito
MatrisDistGenero

?apply
DistritosPuroValido <- knitr::kable(which(apply(MatrisDistGenero == 1 , 1 , sum) == 10), caption = "Distritos con Todos Casos Validos")
DistritosPuroValido
```


##### ¿Cuáles variables son las que registran más distritos con casos insuficientes para pasar la prueba de validación?

```{r}

?apply
CasosInsuficientesPorVariable1 <- apply(MatrisDistGenero == 0 , 2 , sum)
max(CasosInsuficientesPorVariable1)
VariableConMaxInsuficiencia <- knitr::kable(which.max(CasosInsuficientesPorVariable1), caption = "Variable Con Maxima Insuficiencia")
VariableConMaxInsuficiencia

CasosInsuficientesPorVariable <- knitr::kable(CasosInsuficientesPorVariable1, caption = "Casos Insuficientes Por Variable")
CasosInsuficientesPorVariable

```



ENTRE ESTO Y LO SIGUIENTE FALTA!


## Construyendo base de datos 
Voy a guardar esta parte para aqui poner yo creo que los nuevos factores que o cualquier columna que se le necesite agregar a la base de datos de Perfil Sociodemografico que creo que lo hicieron en la nota tecnica.

De estos siguientes tres vectores armar una base de datos con nombres en las columnas:
```{r}

```


mibd <- data.frame(vector1, vector2, vector3) # como cbind()

head(mibd)

colnames(midb) <- c("Pais", "Codigo", "Region")


Ahora borrarla y volver a crearla pero ahora asignandole el nombre de las columnas desde el principio:

rm(mibd)

mibd <- data.frame(Pais = vector1, Codigo = vector2, Region = vector3)

head(mibd)

summary(mibd)

#### Fusionar base de datos
head(PerfilSociodemografico)
head(mibd)


Vamos a fusionar por código ya que es menos probable que existan typos ahí y son universales:

fusionado <- merge(PerfilSociodemografico, mibd, by.x = "Country.Code", by.y = "Code")

head(fusionado)


Remover columna extra que hay:

fusionado$Country <- NULL

str(fusionado)

tail(fusionado)








# Visualizaciones

#### Intro qplot (Aqui utilizare la base de datos de transporte para cambiarle y creo que hace mas sentido de lo que se puede hacer con tsdem)
```{r}
library(ggplot2)

?qplot

str(Transporte)

# Tipo de transporte utilizado
qplot(data=Transporte, x=p5_14)
# Gasto por transporte
qplot(data=Transporte, x=p5_16_2)
# Los dos juntos: gasto por tipo de transporte
qplot(data=Transporte, x=p5_14, y=p5_16_2)


# mappeando el tamaño
qplot(data=Transporte, x=p5_14, y=p5_16_2, size = 3)


# setting el tamaño
qplot(data=Transporte, x=p5_14, y=p5_16_2, size = I(3))



# mappeando el color
qplot(data=Transporte, x=p5_14, y=p5_16_2, size = I(3), color = "blue")



# setting el color
qplot(data=Transporte, x=p5_14, y=p5_16_2, size = I(3), color = I("blue"))

qplot(data=Transporte, x=p5_14, y=p5_16_2, geom="boxplot")



qplot(data=Transporte, x=p5_14, y=p5_16_2)

qplot(data=Transporte, x=p5_14, y=p5_16_2, size=I(4))

qplot(data=Transporte, x=p5_14, y=p5_16_2, size=I(4), color = I("red"))

qplot(data=Transporte, x=p5_14, y=p5_16_2, size=I(4), color = sexo)



```

```{r}
# Figuras
qplot(data=Transporte, x=p5_14, y=p5_16_2, size=I(4), color = sexo,
shape=I(17))

```

![Mas Figuras aqui](/Users/gonzaloarrangoiz/Desktop/Clases de R WRI/Rsymbols.png)


```{r}
# Transparencia

qplot(data=Transporte, x=p5_14, y=p5_16_2, color=sexo, size=I(5),
shape=I(19), alpha=I(0.6))

```

```{r}
# Título

qplot(data=Transporte, x=p5_14, y=p5_16_2, color=sexo, size=I(5),
shape=I(19), alpha=I(0.6), main="Gasto por tipo de transporte")

```

